# 编译原理 - 国防科技大学

## 排版说明
一级标题 课程标题
二级标题 章节
三级标题 小章节
四级标题 知识点

## 1 引论

### 1.1 什么是编译程序
> 翻译, 编译, 解释

#### 什么是翻译程序 (Translator)
源语言程序 => 目标语言程序
1. Compiler: 高级语言程序 => 低级语言程序
2. Interpreter: 源程序作为输入, 不产生目标程序, 边解释边执行源程序

#### 编辑程序分类
1. 诊断编译程序 (Diagnostic Compiler): 调试, 排错
2. 优化编译程序 (Optimizing Compiler): 优化
3. 交叉编译程序 (Cross Compiler): 产生不同于宿主机的目标机的机器代码(分 宿主机, 目标机)
4. 可变目标编译程序 (Retargetable Compiler): 改变目标机有关的部分

### 1.2 为什么要学习编译原理
1. 理解计算系统 (包括但不限 计算机系统)
2. 设计计算系统 (软硬件设计的能力)
3. 训练计算思维

#### 什么是计算思维 (Computational Thinking)
运用计算机科学的基础概念去求解问题, 设计系统, 理解人类的行为
1. 抽象 (Abstraction)
2. 自动化 (Automation): 将抽象思维的结果在计算机上实现
3. 分解 (Decomposition): 大规模 => 小规模
4. 递归 (Recursion): 特殊的分解, 小规模问题和大规模问题是一类问题, 规模足够小时解决特别简单
5. 权衡/折衷 (Tradeoff): 理论可实现 v.s. 实际可实现

### 1.3 编译过程
1. 词法分析 (类比: 识别出句子中的一个个单词)
2. 语法分析 (类比: 分析句子的语法结构)
3. 中间代码产生 (类比: 根据句子的含义进行初步翻译)
4. 优化 (类比: 对译文进行修饰)
5. 目标代码产生 (类比: 写出最后的译文)

#### 词法分析
任务: 对构成源程序的字符串进行扫描和分解, 识别出单词符号
依循的原则: (语言的)构词规则 (用自然语言描述, 不严格)
描述工具: 有限自动机 (用形式化的方法来描述)
例子: `for i := 1 to 100 do // 基本字, 标识符, 赋值号, 整常数, 基本字, 整常数, 基本字`

#### 语法分析
任务: 把单词符号串分解成各类语法单位/语法范畴
依循的原则: (语言的)语法规则 (用自然语言描述, 不严格)
描述工具: 上下文无关文法(用形式化的方法来描述)
例子: `z := x + 0.618 * y; // 算术表达式, 算术表达式, 赋值语句`

#### 中间代码产生
任务: 对语法单位按语言的语义进行初步翻译
依循的原则: (语言的)语义规则(用自然语言描述, 不严格)
描述工具: 属性文法(用形式化的方法来描述)
中间代码: 三元式, 四元式, 树, ...
例子: `四元式: OPR, OPN1, OPN2, RESULT, [序号, 注释]`

#### 优化
任务: 对中间代码加工变化, 以期产生更高效 (时间, 空间) 的目标代码
依循的原则: 程序的等价变换规则
例子: `编写代码可关注可读性, 交由编译器优化提高效率`

#### 目标代码生成
任务: 将中间代码变换成特定机器上的目标代码
依循的原则: 硬件系统结构与机器指令的含义
形式: 
   1. 汇编指令代码: 需要进行汇编
   2. 绝对指令代码: 可直接运行 (如: .exe)
   3. 可重定位指令代码: 需要链接 (如: .obj; 相对地址, 支持模块化开发)

### 1.4 编译程序的结构
1. 编译程序总框
2. 遍
3. 编译前端与后端

#### 编译程序总框
basic:
   1. 词法分析器 => 词法分析 => 单词符号
   2. 语法分析器 => 语法分析 => 语法单位
   3. 语义分析与中间代码生成器 => 中间代码
   4. 优化段 => 优化 => 高效的中间代码
   5. 目标代码生成器 => 目标代码
plus:
   1. 符号表管理
   2. 出错处理

#### 出错处理程序
发现源程序中的错误, 把错误信息报告给用户
1. 语法错误: 源程序中不符合词法, 语法规则的错误
2. 语义错误: 不符合语义规则的错误

#### 遍 (pass)
概念: 对源程序或其中间表示从头到尾扫描一次
与阶段的不同:
1. 一遍可以由若干段组成: 词法分析 & 语法分析 & 中间代码生成 可放在一遍
2. 一个阶段可以分若干遍完成: 优化可以分多遍

#### 编译前端与后端
以中间语言为界来划分
   1. 编译前端: 与源语言相关, 如: 词法分析, 语法分析, 语义分析与中间代码生成, 与机器无关的优化
   2. 编译后端: 与目标机相关, 如: 与目标机有关的优化, 目标代码产生
好处:
   1. 程序逻辑结构更清晰
   2. 优化更充分
   3. 便于移植

### 1.5 编译程序生成
1. 已有某语言的编译程序, 实现另一语言的编译程序
2. 编译程序的移植
3. 自编译方式
4. 编译程序-编译程序