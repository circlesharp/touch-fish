const tree = [
  {
    "Level": 2,
    "children": [
      {
        "BoxGauge": 1,
        "BarCode": "0202012162830",
        "CategoryID": "58f0922f0c8ea811005dbaa5",
        "ImageFixWidthUrl": "https://dev-res.yopoint.cc/operators/20201216/05064f149f6a113f6f7055c04c8faea2.png",
        "ImageUrl": "http://dev-res.yopoint.cc/operators/20201023/e949a736b76af93cb94efe2d773c0ae2.jpg",
        "OutStock": 0,
        "ParentCategoryID": "58e6ee4369c7ef1100ad2f06",
        "Stock": 0,
        "id": "5fd9b182c2a48d000f107de4",
        "display": true,
        "selected": 0,
        "name": "test02"
      }
    ],
    "display": true,
    "id": "58f0922f0c8ea811005dbaa5",
    "items": [
      {
        "BoxGauge": 1,
        "BarCode": "0202012162830",
        "CategoryID": "58f0922f0c8ea811005dbaa5",
        "ImageFixWidthUrl": "https://dev-res.yopoint.cc/operators/20201216/05064f149f6a113f6f7055c04c8faea2.png",
        "ImageUrl": "http://dev-res.yopoint.cc/operators/20201023/e949a736b76af93cb94efe2d773c0ae2.jpg",
        "OutStock": 0,
        "ParentCategoryID": "58e6ee4369c7ef1100ad2f06",
        "Stock": 0,
        "id": "5fd9b182c2a48d000f107de4",
        "display": true,
        "selected": 0,
        "name": "test02"
      },
      {
        "BoxGauge": 20,
        "BarCode": "6928804011296",
        "CategoryID": "58f0922f0c8ea811005dbaa5",
        "ImageFixWidthUrl": "https://res.yopoint.com/product/20190417/7aea125613a5e9348ea4171921310c22.png",
        "ImageUrl": "https://res.yopoint.com/product/20190417/f0dd818c6b651ae01741daf51a0741cf.png",
        "OutStock": 0,
        "ParentCategoryID": "58e6ee4369c7ef1100ad2f06",
        "Stock": 1,
        "id": "5f9bd612770863000f72112d",
        "display": true,
        "selected": 0,
        "name": "芬达橙味330mlCAN"
      }
    ],
    "name": "碳酸饮料",
    "text": "碳酸饮料"
  },
  {
    "Level": 2,
    "children": [
      {
        "BoxGauge": 30,
        "BarCode": "956416205956",
        "CategoryID": "590939b9b9128e1100e477cf",
        "ImageFixWidthUrl": "https://res.yopoint.com/product/20190706/afb50a969bf790bfb8038590f5ed592c.png",
        "ImageUrl": "https://res.yopoint.com/product/20190706/afb50a969bf790bfb8038590f5ed592c.png",
        "OutStock": 0,
        "ParentCategoryID": "58e6ee4369c7ef1100ad2f06",
        "Stock": 0,
        "id": "5fd9b109c2a48d000f107de1",
        "display": true,
        "selected": 0,
        "name": "美汁源"
      }
    ],
    "display": true,
    "id": "590939b9b9128e1100e477cf",
    "items": [
      {
        "BoxGauge": 30,
        "BarCode": "956416205956",
        "CategoryID": "590939b9b9128e1100e477cf",
        "ImageFixWidthUrl": "https://res.yopoint.com/product/20190706/afb50a969bf790bfb8038590f5ed592c.png",
        "ImageUrl": "https://res.yopoint.com/product/20190706/afb50a969bf790bfb8038590f5ed592c.png",
        "OutStock": 0,
        "ParentCategoryID": "58e6ee4369c7ef1100ad2f06",
        "Stock": 0,
        "id": "5fd9b109c2a48d000f107de1",
        "display": true,
        "selected": 0,
        "name": "美汁源"
      }
    ],
    "name": "果蔬汁类",
    "text": "果蔬汁类"
  },
  {
    "Level": 2,
    "children": [
      {
        "BoxGauge": 1,
        "BarCode": "6956416206366",
        "CategoryID": "5924f28b0463491100077330",
        "ImageFixWidthUrl": "http://dev-res.yopoint.cc/product/20200911/f7aa2404e001a2889f24568b32073b60.png",
        "ImageUrl": "http://dev-res.yopoint.cc/product/20200911/c1a6af541d3695f30ccddd835ae91661.png",
        "OutStock": 0,
        "ParentCategoryID": "58e6ee4369c7ef1100ad2f06",
        "Stock": 2,
        "id": "5f5b48835b8c12000fe2a422",
        "display": true,
        "selected": 0,
        "name": "COSTA COFFEE醇正低脂肪醇正拿铁浓咖啡300mlPET瓶"
      }
    ],
    "display": true,
    "id": "5924f28b0463491100077330",
    "items": [
      {
        "BoxGauge": 1,
        "BarCode": "6956416206366",
        "CategoryID": "5924f28b0463491100077330",
        "ImageFixWidthUrl": "http://dev-res.yopoint.cc/product/20200911/f7aa2404e001a2889f24568b32073b60.png",
        "ImageUrl": "http://dev-res.yopoint.cc/product/20200911/c1a6af541d3695f30ccddd835ae91661.png",
        "OutStock": 0,
        "ParentCategoryID": "58e6ee4369c7ef1100ad2f06",
        "Stock": 2,
        "id": "5f5b48835b8c12000fe2a422",
        "display": true,
        "selected": 0,
        "name": "COSTA COFFEE醇正低脂肪醇正拿铁浓咖啡300mlPET瓶"
      }
    ],
    "name": "咖啡饮料",
    "text": "咖啡饮料"
  },
  {
    "Level": 2,
    "children": [
      {
        "BoxGauge": 1,
        "BarCode": "0201907096198",
        "CategoryID": "5924f28b046349110007732e",
        "ImageFixWidthUrl": "https://res.yopoint.com/product/20190709/46a751c6e47e0ff1caa94eaeb793cbcc.png",
        "ImageUrl": "https://res.yopoint.com/product/20190709/46a751c6e47e0ff1caa94eaeb793cbcc.png",
        "OutStock": 0,
        "ParentCategoryID": "58f094160f5dbd1100568db3",
        "Stock": 0,
        "id": "5fc5e9be797604000f18aecb",
        "display": true,
        "selected": 0,
        "name": "双汇泡面搭档香肠"
      }
    ],
    "display": true,
    "id": "5924f28b046349110007732e",
    "items": [
      {
        "BoxGauge": 1,
        "BarCode": "0201907096198",
        "CategoryID": "5924f28b046349110007732e",
        "ImageFixWidthUrl": "https://res.yopoint.com/product/20190709/46a751c6e47e0ff1caa94eaeb793cbcc.png",
        "ImageUrl": "https://res.yopoint.com/product/20190709/46a751c6e47e0ff1caa94eaeb793cbcc.png",
        "OutStock": 0,
        "ParentCategoryID": "58f094160f5dbd1100568db3",
        "Stock": 0,
        "id": "5fc5e9be797604000f18aecb",
        "display": true,
        "selected": 0,
        "name": "双汇泡面搭档香肠"
      }
    ],
    "name": "火腿肠",
    "text": "火腿肠"
  },
  {
    "Level": 2,
    "children": [
      {
        "BoxGauge": 12,
        "BarCode": "0202004232696",
        "CategoryID": "5a37616217ff4a000f86186f",
        "ImageFixWidthUrl": "http://dev-res.yopoint.cc/product/20200423/f6c76520f1c6aae94da18814d0cf94ed.png",
        "ImageUrl": "http://dev-res.yopoint.cc/product/20200423/f6c76520f1c6aae94da18814d0cf94ed.png",
        "OutStock": 0,
        "ParentCategoryID": "5a3760c540b15e0012d84643",
        "Stock": 3,
        "id": "5fa25b6294598b000f1d73c5",
        "display": true,
        "selected": 0,
        "name": "苹果"
      }
    ],
    "display": true,
    "id": "5a37616217ff4a000f86186f",
    "items": [
      {
        "BoxGauge": 12,
        "BarCode": "0202004232696",
        "CategoryID": "5a37616217ff4a000f86186f",
        "ImageFixWidthUrl": "http://dev-res.yopoint.cc/product/20200423/f6c76520f1c6aae94da18814d0cf94ed.png",
        "ImageUrl": "http://dev-res.yopoint.cc/product/20200423/f6c76520f1c6aae94da18814d0cf94ed.png",
        "OutStock": 0,
        "ParentCategoryID": "5a3760c540b15e0012d84643",
        "Stock": 3,
        "id": "5fa25b6294598b000f1d73c5",
        "display": true,
        "selected": 0,
        "name": "苹果"
      }
    ],
    "name": "水果",
    "text": "水果"
  }
];

const deepHandler = (tree, cb, arr) => {
  tree.forEach(group => {
    /* Note: 我发现 items 和 children 的值好像一样的，鉴于 CartLayout 39行用到的是 items, 只更改 items */
    group.items.forEach(goods => {
      cb(goods, arr);
    })
  });
};

const handleIDs = (goods, arr) => {
  arr.push(goods.BarCode);
};

const handleBoxGauges = (goods, arr) => {
  goods.BoxGauge = arr.shift();
}

// step 1 获取 BarCodes
const BarCodes = [];
deepHandler(tree, handleIDs, BarCodes);

// step 2 获取 BoxGauges
const BoxGauges = [111, 222, 333, 444, 555, 666];

// step 3 更新树的 BoxGauge
const resTree = JSON.parse(JSON.stringify(tree));
deepHandler(resTree, handleBoxGauges, BoxGauges);

export default {
  deepHandler,
  handleIDs,
  handleBoxGauges,
};

console.log(BarCodes);
console.log(JSON.stringify(resTree, null, 2));
